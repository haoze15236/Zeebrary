# spring boot 入门

## 启动项目

### jar包发布

- pom文件

  ```xml
  <?xml version="1.0" encoding="UTF-8"?>
  <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
      <modelVersion>4.0.0</modelVersion>
      <parent>
          <groupId>org.springframework.boot</groupId>
          <artifactId>spring-boot-starter-parent</artifactId>
          <version>2.4.2</version>
          <relativePath/>
      </parent>
      <groupId>com.haoze</groupId>
      <artifactId>hello-spring-boot</artifactId>
      <version>0.0.1-SNAPSHOT</version>
      <name>hello-spring-boot</name>
      <description>Demo project for Spring Boot</description>
      <properties>
          <java.version>1.8</java.version>
      </properties>
      <dependencies>
          <dependency>
              <groupId>org.springframework.boot</groupId>
              <artifactId>spring-boot-starter-web</artifactId>
          </dependency>
  
          <dependency>
              <groupId>org.springframework.boot</groupId>
              <artifactId>spring-boot-starter-tomcat</artifactId>
          </dependency>
  
          <dependency>
              <groupId>org.springframework.boot</groupId>
              <artifactId>spring-boot-starter-test</artifactId>
              <scope>test</scope>
          </dependency>
      </dependencies>
  
      <build>
          <!--设置项目打包之后的名称-->
          <finalName>helloSpringBoot</finalName>
          <plugins>
              <plugin>
                  <groupId>org.springframework.boot</groupId>
                  <artifactId>spring-boot-maven-plugin</artifactId>
              </plugin>
          </plugins>
      </build>
  </project>
  ```

- 项目发布

```shell
#cbsfile-0.0.1-SNAPSHOT.jar			jar包名称
#--spring.profiles.active=dev		指定环境配置文件
java -jar cbsfile-0.0.1-SNAPSHOT.jar --spring.profiles.active=dev

```

### war包发布

当项目还需要使用jsp时可采用此打包方式

- pom文件

  ```xml
  <?xml version="1.0" encoding="UTF-8"?>
  <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
      <modelVersion>4.0.0</modelVersion>
      <parent>
          <groupId>org.springframework.boot</groupId>
          <artifactId>spring-boot-starter-parent</artifactId>
          <version>2.4.2</version>
          <relativePath/> <!-- lookup parent from repository -->
      </parent>
      <groupId>com.haoze</groupId>
      <artifactId>hello-spring-boot</artifactId>
      <version>0.0.1-SNAPSHOT</version>
      <name>hello-spring-boot</name>
      <!--修改打包方式为war-->
      <packaging>war</packaging>
      <description>Demo project for Spring Boot</description>
      <properties>
          <java.version>1.8</java.version>
      </properties>
      <dependencies>
          <dependency>
              <groupId>org.springframework.boot</groupId>
              <artifactId>spring-boot-starter-web</artifactId>
          </dependency>
          <dependency>
              <groupId>org.springframework.boot</groupId>
              <artifactId>spring-boot-starter-tomcat</artifactId>
              <!--修改tomcat启动依赖的范围,即打包时排除此依赖-->
              <scope>provided</scope>
          </dependency>
          <dependency>
              <groupId>org.springframework.boot</groupId>
              <artifactId>spring-boot-starter-test</artifactId>
              <scope>test</scope>
          </dependency>
      </dependencies>
  
      <build>
          <!--设置项目打包之后的名称-->
          <finalName>helloSpringBoot</finalName>
          <plugins>
              <plugin>
                  <groupId>org.springframework.boot</groupId>
                  <artifactId>spring-boot-maven-plugin</artifactId>
              </plugin>
          </plugins>
      </build>
  </project>
  ```

- 修改启动配置类

  ```java
  package com.haoze.hellospringboot;
  
  import org.springframework.boot.SpringApplication;
  import org.springframework.boot.autoconfigure.SpringBootApplication;
  import org.springframework.boot.builder.SpringApplicationBuilder;
  import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;
  
  @SpringBootApplication
  public class HelloSpringBootApplication extends SpringBootServletInitializer {
  
      public static void main(String[] args) {
          SpringApplication.run(HelloSpringBootApplication.class, args);
      }
  	/**
  	*打war包需要启动类继承SpringBootServletInitializer 并修改重写configure方法
  	*/
      @Override
      protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {
          return builder.sources(HelloSpringBootApplication.class);
      }
  
  }
  
  ```

  

## 项目环境指定

**jvm启动参数设置:** `-Dspring.profiles.active=prod`

**yml配置文件设定:**

```properties
spring:
  profiles:
    active: dev
---
spring:
  config:
    activate:
      on-profile: prod
server:
  port: 8989
---
spring:
  config:
    activate:
      on-profile: dev
server:
  port: 8080
```


# 数据库

- 使用excel表模板生成表
- 更新数据时候需要加上OBJECT_VERSION_NUMBER字段，用于处理锁

# Java

- **空值判断：**

  - ```java
    ObjectUtils.isEmpty()
    ```

  - ```java
    CollectionUtils.isEmpty()
    ```

# 接口

## 同步数据接口

1. 分页同步数据到接口表
   
- 接口表要有msg字段，用于记录拉取的单条信息业务逻辑上的错误原因
   - 每次同步之前失效所有接口表数据，防止上游系统真实删除数据。
   
2. 初始化接口关联数据

   - 全量查询，避免每条数据都请求数据库查询关联数据

   ```java
    //初始化
   IRequest request = RequestHelper.getCurrentRequest(true);
   //部门
   expOrgUnitList = expOrgUnitMapper.selectAll();
   //公司
   fndCompanyList = fndCompanyMapper.selectAll();
   //部门级别
   expOrgUnitLevelList = expOrgUnitLevelMapper.selectAll();
   //部门类型
   expOrgUnitTypeList = expOrgUnitTypeMapper.selectAll();
   ```
   
3. 接口数据映射业务表

   ```java
   employeeBasicList.forEach(employeeBasic -> {
               //------------------数据映射--------------------
               //员工
               ExpEmployee expEmployee = new ExpEmployee();
               expEmployee.setEmployeeId(employeeBasic.getEmployeeId());
               expEmployee.setEmployeeCode(employeeBasic.getEmployeeNo());
               expEmployee.setName(employeeBasic.getEmployeeName());
               expEmployee.setEmail(employeeBasic.getPersonalEmail());
               expEmployee.setMobil(employeeBasic.getPhoneNumber());
               expEmployee.setPhone(employeeBasic.getPhoneNumer());
               }
   ```

4. 更新/插入/删除业务表

   ```java
   //插入集合
   List<CityBasic> insertList = reqList.stream()
       				.filter(reqCity -> !selList.stream()
                       .map(CityBasic::getId)
                       .collect(Collectors.toList())
                       .contains(reqCity.getId())).collect(Collectors.toList());
   //更新集合
   List<CityBasic> updateList = selList.stream()
                       .map(selCity -> reqList.stream()
                               			   .filter(reqCity -> Objects.equals(selCity.getId(),reqCity.getId()))
                               			   .findFirst()
                               			   .map(reqData -> { reqData.setObjectVersionNumber(selCity.getObjectVersionNumber());
                                   return reqData;
                               				})
                               			   .orElse(null))
                       .filter(Objects::nonNull)
                       .collect(Collectors.toList());
   //删除集合
   List<CityBasic> deleteList = selList.stream()
       				.filter(selCity -> !reqList.stream()
                       .map(CityBasic::getId)
                       .collect(Collectors.toList())
                       .contains(selCity.getId()))
       				.collect(Collectors.toList());
   ```

   

# Git规范

## 创建分支

| 前缀       | 含义                                                       |
| ---------- | ---------------------------------------------------------- |
| master     | 主分支,可用的,稳定的,可发布的版本                          |
| develop    | 开发主分支,最新的代码分支                                  |
| feature-** | 功能开发分支                                               |
| bugfix-**  | 未发布bug修复分支（例如：以猪齿鱼的问题编号:bugfix-hssp-76 |
| release-** | 预发布版本                                                 |
| hotfix-**  | 已发布bug修复分支                                          |

开发需要建立自己的开发分支：d-工号

## 提交备注

- [ADD] 添加实现新功能
- [FIX] 修正BUG
- [REM] 删除不需要的文件
- [IMP] 提升改善正在开发或者已经实现的功能
- [REF] 重构一个功能，对功能进行重写